# Story 11.4: Connect Real Vendor Metrics to Dashboard

## Status
Draft

## Story

**As an** admin
**I want** to see real vendor engagement data
**So that** I can assess marketplace performance

## Acceptance Criteria

1. Vendor metrics cards updated with real data:
   - Total Vendors (count of all vendors)
   - Active Vendors (vendors with matches)
   - Total Clicks (vendor profile views)
   - Contacts Made (inquiry submissions)
2. Top Vendors list updated:
   - Show top 5 vendors by engagement score
   - Display company name, click count, trend indicator
   - Trend arrows (up/down) with color coding
3. Vendor category breakdown:
   - Horizontal bar chart showing clicks by category
   - Top 8 categories displayed
4. Vendor conversion funnel added:
   - Vendors Viewed → Vendors Contacted → RFPs Sent
5. Real-time updates every 5 minutes
6. Click on vendor navigates to `/admin/vendors?id={vendorId}`

## Tasks / Subtasks

- [ ] Task 1: Add Vendor Analytics API Client (AC: 1)
  - [ ] Add `getVendorAnalytics` to frontend/src/lib/api.ts
  - [ ] Create TanStack Query hook in Dashboard component
  - [ ] Query key: `['admin-analytics-vendors', dateParams]`
  - [ ] Enable auto-refresh: refetchInterval 300000 (5 min)

- [ ] Task 2: Update Vendor Metrics Cards (AC: 1)
  - [ ] Replace mock vendorMetrics (Dashboard.tsx:46-52)
  - [ ] Use data from API: totalVendors, activeVendors, totalClicks, totalContacts
  - [ ] Add loading skeletons
  - [ ] Calculate and display conversion rate

- [ ] Task 3: Update Top Vendors List (AC: 2, 6)
  - [ ] Replace mock top vendors data (lines 310-315)
  - [ ] Map API topVendors to UI format
  - [ ] Display trend with colored arrows (up/down/stable)
  - [ ] Make vendor name clickable, navigate to /admin/vendors?id={vendorId}
  - [ ] Show engagement metrics (clicks, contacts)

- [ ] Task 4: Add Category Breakdown Chart (AC: 3)
  - [ ] Create horizontal BarChart component
  - [ ] Use clicksByCategory data from API
  - [ ] Display top 8 categories
  - [ ] Show clicks and contacts per category
  - [ ] Color code bars

- [ ] Task 5: Add Vendor Conversion Funnel (AC: 4)
  - [ ] Create funnel data structure
  - [ ] Stages: Vendors Viewed → Contacted → RFPs
  - [ ] Use Recharts FunnelChart
  - [ ] Display conversion percentages

- [ ] Task 6: Testing
  - [ ] Test API integration
  - [ ] Test metrics display
  - [ ] Test vendor navigation
  - [ ] Test charts render correctly

## Dev Notes

### API Integration Pattern
```typescript
const { data: vendorData } = useQuery({
  queryKey: ['admin-analytics-vendors'],
  queryFn: () => adminApi.getVendorAnalytics(),
  refetchInterval: 300000,
  staleTime: 60000
});
```

### Trend Indicator Component
```tsx
const TrendIndicator = ({ trend }: { trend: 'up' | 'down' | 'stable' }) => {
  if (trend === 'up') return <TrendingUp className="h-4 w-4 text-green-500" />;
  if (trend === 'down') return <TrendingDown className="h-4 w-4 text-red-500" />;
  return <Minus className="h-4 w-4 text-gray-500" />;
};
```

### File Locations
- `frontend/src/lib/api.ts` - Add getVendorAnalytics
- `frontend/src/pages/admin/Dashboard.tsx` - Update vendor sections

---

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-24 | 1.0 | Story created | Bob (Scrum Master) |

---

## Dev Agent Record
_To be populated by dev agent_

## QA Results
_To be populated by QA agent_
